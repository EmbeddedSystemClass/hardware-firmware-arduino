
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Temperature</title>
<script>
    const GRAPH_TOP = 25;
    const GRAPH_LEFT = 50;
    const GRAPH_WIDTH = 20 * 25;
    const GRAPH_HEIGHT = 13 * 25;
    
    const GRAPH_MARGIN_PY = 25;
    const GRAPH_MARGIN_PX = 25;
    const GRAPH_GRID_PY = 25;
    const GRAPH_GRID_PX = 25;
    const GRAPH_ZERO_PY = GRAPH_TOP + GRAPH_MARGIN_PY + 10 * GRAPH_GRID_PY;
    
    
    var data = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    var svgNS = "http://www.w3.org/2000/svg";  
    
    function Init()
    {	        
        IntervalComboInit();
        GetTemperature();
        //UpdateGraphDummy();
    }
    
    function GetTemperature()
    {
        var request = new XMLHttpRequest();

        request.onreadystatechange = function()
        {
            if (this.readyState == 4) {
                if (this.status == 200) {
                    if (this.responseXML != null) {
                        for(var i = 0; i < 20; i++) {
                            data[i] = this.responseXML.getElementsByTagName('analog')[i].childNodes[0].nodeValue;
                        }
                        UpdateGraph();
                    }
                }
            }
        }

        request.open("GET", "temperatur_data", true);
        request.send(null);
        
        setTimeout("GetTemperature()", 3000);
    }
    
    function UpdateGraph()
    {
        var path = document.getElementById("path");
        var segments = path.pathSegList;
        
        var x = GRAPH_LEFT + GRAPH_MARGIN_PX;
        
        segments.getItem(0).y = GRAPH_ZERO_PY;
        segments.getItem(0).x = x;
        
        segments.getItem(21).y = GRAPH_ZERO_PY;
        segments.getItem(21).x = GRAPH_LEFT + GRAPH_WIDTH;
            
        for(var i = 0; i < 20; i++) {
            var y = data[i] * -2.5 + GRAPH_ZERO_PY;
            var circle = document.getElementById("c" + i);			
            circle.setAttributeNS(null, "cy", y);
            circle.setAttributeNS(null, "cx", x);
            if(data[i] != GRAPH_ZERO_PY)
                circle.setAttributeNS(null,"visibility","visible");
            
            segments.getItem(i+1).y = parseInt(y);
            segments.getItem(i+1).x = x;
            
            x += GRAPH_GRID_PX;
        }        
        
        for(var i = 0; i < 21; i++) {
            data[i] = data[i + 1];
        }        
    }
    
    function UpdateGraphDummy()
    {
        var path = document.getElementById("path");
        var segments = path.pathSegList;
        
        var x = GRAPH_LEFT + GRAPH_MARGIN_PX;
        
        segments.getItem(0).y = GRAPH_ZERO_PY;
        segments.getItem(0).x = x;
        
        segments.getItem(21).y = GRAPH_ZERO_PY;
        segments.getItem(21).x = GRAPH_LEFT + GRAPH_WIDTH;
            
        for(var i = 0; i < 20; i++) {
            var y = data[i] * -2.5 + GRAPH_ZERO_PY;
            var circle = document.getElementById("c" + i);			
            circle.setAttributeNS(null, "cy", y);
            circle.setAttributeNS(null, "cx", x);
	    
            if(data[i] != GRAPH_ZERO_PY)
                circle.setAttributeNS(null,"visibility","visible");
            
            segments.getItem(i+1).y = parseInt(y);
            segments.getItem(i+1).x = x;
            
            x += GRAPH_GRID_PX;
        }


        data[20] = 20;//Math.random() * 100;
        
        for(var i = 0; i < 21; i++) {
            data[i] = data[i + 1];
        }

        setTimeout("UpdateGraphDummy()", 3000);
    }
    
    function OnStartLog()
    {
        alert("Start");
    }
    
    function OnStoppLog()
    {
        alert("Stopp");
    }
    
    function IntervalComboInit()
    {
        var intervalInputBox = document.getElementById("intervalInput");
        var intervalComboBox = document.getElementById("intervalCombo");
        var idx = intervalComboBox.selectedIndex;
        var content = intervalComboBox.options[idx].value;
        if(intervalInputBox.value == "")
            intervalInputBox.value = content;	
    }

    function IntervalComboOnChange(intervalComboBox, intervalInputBox)
    {
        intervalInputBox = document.getElementById(intervalInputBox);  
        var idx = intervalComboBox.selectedIndex;
        var content = intervalComboBox.options[idx].value;
        intervalInputBox.value = content;	
    }
</script>
  <style type="text/css">
      body {
        background-color: #b8b8b8;
      }
      svg.graph {	    
        height: 400px;
        width: 600px;
      }
      svg.graph .grid {
        stroke: white;
        stroke-dasharray: 1 2;
        stroke-width: 1;
      }
      svg.graph .points {
        stroke: white;
        stroke-width: 3;
      }
      svg.graph .first_set {
        fill: #000000;
      }
      svg.graph .surfaces {
        fill-opacity: 0.5;
      }
      svg.graph .grid.double {
        stroke-opacity: 0.4;
      }
      svg.graph .labels {
        font-family: Arial;
        font-size: 14px;
        kerning: 1;
      }
      svg.graph .labels.x-labels {
        text-anchor: middle;
      }
      svg.graph .labels.y-labels {
        text-anchor: end;       
      }

    fieldset {
        padding-top:10px;
        padding-bottom:10px;
        font-family: Arial;
        font-size: 12px;
        kerning: 1;
        width: 600px;
        border:1px solid #666;
        border-radius:4px;		    
    }
        
        
  </style>
</head>
<body onload="Init()">
  <fieldset style="" name="files">
    <legend>Temperature chart</legend>
    <svg id="temp-graph" class="graph" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
      <g class="grid x-grid" id="xGrid">
        <line x1="75" x2="75" y1="50" y2="375"></line>
        <line x1="100" x2="100" y1="50" y2="375"></line>
        <line x1="125" x2="125" y1="50" y2="375"></line>
        <line x1="150" x2="150" y1="50" y2="375"></line>
        <line x1="175" x2="175" y1="50" y2="375"></line>
        <line x1="200" x2="200" y1="50" y2="375"></line>
        <line x1="225" x2="225" y1="50" y2="375"></line>
        <line x1="250" x2="250" y1="50" y2="375"></line>
        <line x1="275" x2="275" y1="50" y2="375"></line>
        <line x1="300" x2="300" y1="50" y2="375"></line>
        <line x1="325" x2="325" y1="50" y2="375"></line>
        <line x1="350" x2="350" y1="50" y2="375"></line>
        <line x1="375" x2="375" y1="50" y2="375"></line>
        <line x1="400" x2="400" y1="50" y2="375"></line>
        <line x1="425" x2="425" y1="50" y2="375"></line>
        <line x1="450" x2="450" y1="50" y2="375"></line>
        <line x1="475" x2="475" y1="50" y2="375"></line>
        <line x1="500" x2="500" y1="50" y2="375"></line>
        <line x1="525" x2="525" y1="50" y2="375"></line>
        <line x1="550" x2="550" y1="50" y2="375"></line>
        
        <line x1="75" x2="550" y1="50" y2="50"></line>
        <line x1="75" x2="550" y1="75" y2="75"></line>
        <line x1="75" x2="550" y1="100" y2="100"></line>
        <line x1="75" x2="550" y1="125" y2="125"></line>
        <line x1="75" x2="550" y1="150" y2="150"></line>
        <line x1="75" x2="550" y1="175" y2="175"></line>
        <line x1="75" x2="550" y1="200" y2="200"></line>
        <line x1="75" x2="550" y1="225" y2="225"></line>
        <line x1="75" x2="550" y1="250" y2="250"></line>
        <line x1="75" x2="550" y1="275" y2="275"></line>
        <line x1="75" x2="550" y1="300" y2="300"></line>
        <line x1="75" x2="550" y1="325" y2="325"></line>
        <line x1="75" x2="550" y1="350" y2="350"></line>
        <line x1="75" x2="550" y1="375" y2="375"></line>
      </g>
      <g class="labels x-labels" id="xAxisLabels">
        <text x="75" y="400">1</text>
        <text x="100" y="400">2</text>
        <text x="125" y="400">3</text>
        <text x="150" y="400">4</text>
        <text x="175" y="400">5</text>
        <text x="200" y="400">6</text>
        <text x="225" y="400">7</text>
        <text x="250" y="400">8</text>
        <text x="275" y="400">9</text>
        <text x="300" y="400">10</text>
        <text x="325" y="400">11</text>
        <text x="350" y="400">12</text>
        <text x="375" y="400">13</text>
        <text x="400" y="400">14</text>
        <text x="425" y="400">15</text>
        <text x="450" y="400">16</text>
        <text x="475" y="400">17</text>
        <text x="500" y="400">18</text>
        <text x="525" y="400">19</text>
        <text x="550" y="400">20</text>
      </g>
      <g class="labels y-labels" id="yAxisLabels">
        <text x="50" y="55">100</text>
        <text x="50" y="80">90</text>
        <text x="50" y="105">80</text>
        <text x="50" y="130">70</text>
        <text x="50" y="155">60</text>
        <text x="50" y="180">50</text>
        <text x="50" y="205">40</text>
        <text x="50" y="230">30</text>
        <text x="50" y="255">20</text>
        <text x="50" y="280">10</text>
        <text x="50" y="305">0</text>
        <text x="50" y="330">-10</text>
        <text x="50" y="355">-20</text>
        <text x="50" y="380">-30</text>
        <text x="50" y="25">Â°C</text>
      </g>
      <g class="surfaces">
        <path id="path" class="first_set" d="M 75 300 L 75 275 L 100 300 L 125 125 L 150 250 L 175 150 L 200 175 L 225 75 L 250 100 L 275 150 L 300 100 L 325 275 L 350 275 L 375 200 L 400 75 L 425 325 L 450 150 L 475 325 L 500 200 L 525 275 L 550 300 L 550 300 Z"></path>
      </g>
      <g class="first_set points" data-setname="Our first data set">
        <circle id="c0" cx="75" cy="275" r="5" visibility="visible"></circle>
        <circle id="c1" cx="100" cy="300" r="5" visibility="visible"></circle>
        <circle id="c2" cx="125" cy="125" r="5" visibility="visible"></circle>
        <circle id="c3" cx="150" cy="250" r="5" visibility="visible"></circle>
        <circle id="c4" cx="175" cy="150" r="5" visibility="visible"></circle>
        <circle id="c5" cx="200" cy="175" r="5" visibility="visible"></circle>
        <circle id="c6" cx="225" cy="75" r="5" visibility="visible"></circle>
        <circle id="c7" cx="250" cy="100" r="5" visibility="visible"></circle>
        <circle id="c8" cx="275" cy="150" r="5" visibility="visible"></circle>
        <circle id="c9" cx="300" cy="100" r="5" visibility="visible"></circle>
        <circle id="c10" cx="325" cy="275" r="5" visibility="visible"></circle>
        <circle id="c11" cx="350" cy="275" r="5" visibility="visible"></circle>
        <circle id="c12" cx="375" cy="200" r="5" visibility="visible"></circle>
        <circle id="c13" cx="400" cy="75" r="5" visibility="visible"></circle>
        <circle id="c14" cx="425" cy="325" r="5" visibility="visible"></circle>
        <circle id="c15" cx="450" cy="150" r="5" visibility="visible"></circle>
        <circle id="c16" cx="475" cy="325" r="5" visibility="visible"></circle>
        <circle id="c17" cx="500" cy="200" r="5" visibility="visible"></circle>
        <circle id="c18" cx="525" cy="275" r="5" visibility="visible"></circle>
        <circle id="c19" cx="550" cy="300" r="5" visibility="visible"></circle>
      </g>
    </svg>
  </fieldset>
  <form method = "get" action="file.txt">
    <p/>
    <fieldset name="logging">
        <legend>Logging</legend>
        <table style="width:100%">
          <tr>
            <td>
                <input name="START_LOG" value="Start Log" type="button" onclick="OnStartLog()">
                <input name="STOPP_LOG" value="Stopp Log" type="button" onclick="OnStoppLog()">
            </td>
            <td>
                <label>Interval[s]:</label>		
                <input type="text" id="intervalInput" name="intervalInput" style="width: 50px"/>
                <select id="intervalCombo" name="intervalCombo" onChange="IntervalComboOnChange(this, "intervalInput")">
                    <option value="1">1s</option>
                    <option value="60">1m</option>
                    <option value="600">10m</option>
                    <option value="3600">1h</option>
                </select>    
            </td> 
            <td>			
                <label>State:</label>	
                <label id = "stateLabel"><font color="red"><b>Off</b></font></label>
            </td>
          </tr> 
        </table>
    </fieldset>
    <p/>
    <fieldset name="files">
        <legend>Files</legend>
        <select name="download" size="5" style="width: 300px">
            <option>0000.csv</option>
            <option>0001.csv</option>
            <option>0002.csv</option>
            <option>0003.csv</option>
            <option>0004.csv</option>
            <option>0005.csv</option>
            <option>0006.csv</option>
            <option>0007.csv</option>
            <option>0008.csv</option>
            <option>0009.csv</option>
        </select>
        <p/>
        <input name="refreshButton" value="Refresh" type="submit">
        <input name="downloadButton" value="Download" type="submit">		
    </fieldset>
 
</body>
</html>








